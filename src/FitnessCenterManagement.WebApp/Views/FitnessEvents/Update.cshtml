@using FitnessCenterManagement.WebApp.Views.Shared.Resources
@using FitnessCenterManagement.WebApp.Views.FitnessEvents.Resources
@model FitnessCenterManagement.WebApp.Models.FitnessEventModel
@{
    ViewData["Title"] = FitnessEventsRes.UpdateItem;
}

<h2>@ViewData["Title"]</h2>
<hr />
<form asp-controller="FitnessEvents" asp-action="edit" asp-antiforgery="true" method="post">
    <div class="validation" asp-validation-summary="ModelOnly"></div>
    <input asp-for="Id" hidden="hidden" />

    <div class="form-group row">
        <label asp-for="ServiceId" class="col-md-2 control-label"></label>
        <div class="col-sm-10">
            <select asp-for="ServiceId" class="form-control">
                <option value="" id="dropDownServicesChooseValue" disabled="disabled" selected="selected">@SharedStringRes.ChooseDropdownHint</option>
            </select>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="VenueId" class="col-md-2 control-label"></label>
        <div class="col-sm-10">
            <select asp-for="VenueId" class="form-control">
                <option value="" id="dropDownVenuesChooseValue" disabled="disabled" selected="selected">@SharedStringRes.ChooseDropdownHint</option>
            </select>
        </div>
    </div>

    <div class="form-group row">
        <label asp-for="Minutes" class="col-md-2 control-label"></label>
        <div class="col-sm-10">
            <input asp-for="Minutes" class="form-control" , placeholder="@FitnessEventsRes.MinutesLabel" />
            <span asp-validation-for="Minutes" class="text-danger"></span>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-sm-10">
            <input type="submit" class="btn btn-primary btn-icon" value="@SharedStringRes.UpdateBtn" />
        </div>
    </div>
</form>


@await Html.PartialAsync("_ReturnGrayButton", ("Index", "FitnessEvents", SharedStringRes.GoBackBtn))

@section Scripts{
    <script>
        $(document).ready(loadVenuesDropdown());
        $(document).ready(loadServicesDropdown());

        function loadVenuesDropdown() {
            var dropdownElement = document.getElementsByTagName("select")[1].children[0];
            $.ajax({
                type: 'GET',
                url: '/Venues/find',
                error: function (error) {
                    console.log('Error with receiving data: ' + error)
                },
                success: function (result) {
                    let s = '';
                    if (result.length > 0) {
                        for (let el of result) {
                            let str = '';
                            if (el.id == @{ @Model.VenueId}) {
                                str = 'selected';
                            }
                            s += '<option ' + str + ' value="' + el.id + '">' + el.name + ' (' + el.location + ')</option>';
                        }
                    }
                    $(dropdownElement).after(s);
                }
            });
        };

        function loadServicesDropdown() {
            var dropdownElement = document.getElementsByTagName("select")[0].children[0];
            $.ajax({
                type: 'GET',
                url: '/Services/find',
                error: function (error) {
                    console.log('Error with receiving data: ' + error)
                },
                success: function (result) {
                    let s = '';
                    if (result.length > 0) {
                        for (let el of result) {
                            let str = '';
                            if (el.id == @{ @Model.ServiceId}) {
                                str = 'selected';
                            }
                            s += '<option '+str+' value="' + el.id + '">' + el.name + ' (\$' + el.price + ')</option>';
                        }
                    }
                    $(dropdownElement).after(s);
                }
            });
        };
    </script>
}